import { Meta } from '@storybook/addon-docs/blocks'
import LinkTo from '@storybook/addon-links/react'

<Meta title="Getting Started/Installation" />

# Installation

In the next steps we'll show you how to install `@saas-ui/pro`.

You'll need a valid license to install `@saas-ui/pro`, you can order one at [saas-ui.dev](https://saas-ui.dev/#pricing).

Before continuing [follow these steps](https://www.saas-ui.dev/docs/getting-started) to set up `@saas-ui/react` and `@chakra-ui/react` in your project, if you haven't done so already.

## Configuration

All pro packages can be installed from our private NPM registry at https://npm.saas-ui.dev.
After [redeeming](https://saas-ui.dev/redeem) your license, an account will be automatically created.

Your NPM account is a combination of the Github username you used to redeem your license and the license code (`username:licenseKey`).

### Yarn

In the root of your project edit `.yarnrc.yml` and add the following lines.

```yml
npmScopes:
  saas-ui:
    npmRegistryServer: 'https://npm.saas-ui.dev'
npmRegistries:
  //npm.saas-ui.dev:
    npmAuthIdent: '${SAAS_UI_TOKEN:-}'
    npmAlwaysAuth: true
```

To set it up on your dev machine add this to `~/.profile`.

```bash
export SAAS_UI_TOKEN="GithubUsername:licenseKey"
```

The same configuration can be used for CI and deployments.

### NPM & PNPM

On your development machine you can run this and enter your Github username as user and license key as password.

```bash
pnpm login --registry=https://npm.saas-ui.dev/
```

#### Manual & CI configuration.

Add your auth token to `~/.profile`

```bash
export SAAS_UI_TOKEN="GithubUsername:licenseKey"
```

Then edit `.npmrc` in the root of your project and add the following lines.

```
@saas-ui:registry=https://npm.saas-ui.dev
//npm.saas-ui.dev/:_auth="${SAAS_UI_TOKEN}"
//npm.saas-ui.dev/:always-auth=true
```

##### PNPM

PNPM expects auth to be base64 encoded, so make sure `SAAS_UI_TOKEN` is encoded.

```bash
echo -n 'GithubUsername:licenseKey' | base64
```

If you're having troubles generating a working base64 encoded string, try [this website](https://www.base64encode.org/).

### Configure your bundler

The Pro packages are published in Typescript, this might not work out of the box with your app.
You'll need to configure your bundler to transpile the Pro packages to plain Javascript.

- `@saas-ui/pro`
- `@saas-ui/billing`
- `@saas-ui/charts`
- `@saas-ui/date-picker`
- `@saas-ui/features`
- `@saas-ui/onboarding`
- `@saas-ui/router`

#### Next.js

Edit `next.config.js` and add a custom webpack config.
This will work for both Babel and SWC transpilers.

```js
module.exports = {
  webpack: (config, { defaultLoaders }) => {
    config.module.rules.push({
      test: /node_modules\/@saas-ui\/(pro|billing|charts|date-picker|features|onboarding|router)\/.*\.tsx?/,
      use: [defaultLoaders.babel],
    })
    return config
  },
}
```

#### React Create App (CRA)

To use a custom Webpack config with CRA you either need to eject the app or install `react-app-rewired` and follow [their instructions](https://github.com/timarney/react-app-rewired#how-to-rewire-your-create-react-app-project).

```bash
yarn add -D react-app-rewired ts-loader
```

Add this to `config-overrides.js`

```js
module.exports = function override(config) {
  config.module.rules.push({
    test: /node_modules\/@saas-ui\/(pro|billing|charts|date-picker|features|onboarding|router)\/.*\.tsx?/,
    loader: 'ts-loader',
  })
  return config
}
```

## Install

```
yarn add @saas-ui/pro
```

```
pnpm install @saas-ui/pro
```

```
npm install @saas-ui/pro
```

## Setup types

Install `@types/react-table` as a dev dependency to your project.

Create a `react-table.d.ts` file somewhere in your project, eg in `/types`

```ts react-table.d.ts
export * from '@saas-ui/pro/src/data-grid/react-table-config'
```

## Troubleshooting

### Authentication error

- If you get an authentication error from npm, restart your terminal to make sure `SAAS_UI_TOKEN` is loaded, and try again.

- If you use PNPM make sure the token is properly base64 encoded.

## Next

Awesome! Now it's time to [configure your theme](/story/getting-started-theme--page).
